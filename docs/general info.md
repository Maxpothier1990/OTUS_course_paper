# 2. Общие сведения

Настоящий документ определяет полный набор требований заинтересованных сторон, функциональных и нефункциональных требований к создаваемой информационной системе управления рестораном быстрого питания «КиберФуд» (далее – Система). Документ служит основанием для проектирования архитектуры, разработки, тестирования, приемки и ввода в промышленную эксплуатацию Системы

## 2.1 Назначение системы

Информационная система «КиберФуд» предназначена для ресторанов быстрого питания оборудованными терминалами самообслуживания для автоматизации цикла обслуживания клиента в ресторанах быстрого питания от выбора и оплаты заказа до его выдачи, с минимальным участием персонала.

## 2.2 Обзор системы

<p>Система представляет собой комплексную платформу автоматизации для ресторанного бизнеса, объединяющую цифровые каналы взаимодействия с клиентами, автоматизированное производство блюд и внутренние бизнес-процессы.</p>

<p>Основными элементами являются:</p>
<p>1. Клиентские интерфейсы (Фронтенд): Табло, веб- и мобильные приложения для покупателей; веб-интерфейс для сотрудников; интеграция с кассовой системой 1С.</p>
<p>2. Ядро платформы (Бэкенд): Набор взаимосвязанных микросервисов (управление заказами, меню, оплатой, доставкой и т.д.), объединенных через API Gateway и брокер сообщений Kafka.</p>
<p>3. Внешние интегрируемые системы: Платежные шлюзы, роботизированный комплекс, системы складского учета (1C/ERP), фискальные регистраторы.</p>

Взаимодействие: Покупатели и сотрудники взаимодействуют с системой через соответствующие интерфейсы, которые направляют запросы в единую точку входа (API Gateway). Gateway маршрутизирует запросы к нужным сервисам, которые синхронно выполняют основную бизнес-логику, а для фоновых задач (уведомления, аналитика) публикуют события в Kafka. Критичные бизнес-процессы (например, создание заказа) требуют взаимодействия нескольких сервисов и, в некоторых случаях, внешних систем (например, для проведения оплаты).

Основные интерфейсы, пересекающие границы системы, представлены на UML-диаграмме компонентов, которая является неотъемлемой частью настоящего ТЗ. Она наглядно отображает контейнеры (фронтенд, бэкенд, внешние системы) и связи между ними.

![](out/C4Level2.svg)

Основные возможности:
<p>1. Мультиканальное оформление заказов: Прием заказов через табло, веб-сайт, мобильное приложение и кассу (1С).</p>
<p>2. Управление производством: Формирование технологических карт и управление роботизированным комплексом для автоматического приготовления блюд.</p>
<p>3. Финансовые операции: Обработка онлайн- и оффлайн-платежей, интеграция с эквайрингом и фискальными аппаратами, управление чеками.</p>
<p>4. Доставка и исполнение: Управление жизненным циклом заказа, расчет сроков, маршрутизация доставок.</p>
<p>5. Маркетинг и аналитика: Управление программой лояльности, проведение акций, сбор и анализ бизнес-статистики.</p>
<p>6. Коммуникация: Автоматическая отправка уведомлений (SMS, Push) клиентам на ключевых этапах заказа.</p>

Условия и ограничения:
- Система предназначена для круглосуточной работы (24/7).
- Критичные операции (создание/оплата заказа) должны выполняться синхронно с гарантией ответа.
- Не критичные по времени операции (аналитика, уведомления) выполняются асинхронно через брокер сообщений.

### 1.2.1 Перспектива продукта

Разрабатываемая система (далее – «Продукт») представляет собой цифровую платформу для автоматизации заказов и обслуживания в сфере общественного питания с элементами роботизированного производства. Продукт является ключевым элементом более крупной экосистемы, включающей внешние коммерческие, финансовые и производственные системы.

Продукт функционирует в рамках следующих ограничений и интерфейсов:

#### 1.2.1.1 Системные интерфейсы
Продукт предоставляет единую точку входа для всех клиентских приложений через API Gateway и взаимодействует с рядом внешних систем для выполнения бизнес-процессов.
Интерфейс с Внешними Системами (через соответствующие Сервисы Бэкенда):
- Назначение: Обмен данными для расширения функциональности Продукта.
- Описание:
1. Интерфейс с Платежным шлюзом (payment_gateway): Обеспечивает безопасное проведение финансовых транзакций. Сервис Оплаты (ServicePayment) отправляет данные для списания и получает подтверждение/отказ.
2. Интерфейс с Роботизированным комплексом (robot_system): Управление автоматизированным приготовлением. Сервис Робототехники (ServiceRobotics) отправляет технологические карты и команды, получает статусы оборудования.
3. Интерфейс с Системой складского учета (warehouse_system): Синхронизация данных об остатках ингредиентов и товаров. Сервис Меню (ServiceMenu) может запрашивать или получать обновления по остаткам.
4. Интерфейс с Фискальным терминалом (cash): Регистрация наличных платежей в соответствии с 54-ФЗ. Сервис Оплаты (ServicePayment) формирует и отправляет фискальные данные.

#### 1.2.1.2 Пользовательские интерфейсы
Логические характеристики интерфейсов определены для каждой категории пользователей:
Покупатели (infomat, web_app, mobil_app): Минималистичный, интуитивно понятный интерфейс для просмотра меню, формирования заказа, выбора способа оплаты и отслеживания статуса. Приоритет – скорость и простота.
Сотрудники/Администраторы (Admin_web_app): Интерфейс с расширенным функционалом: управление меню, ценообразование, просмотр статистики, управление заказами, мониторинг работы роботов. Требуется аутентификация и разграничение прав.
Кассиры (1С): Специализированный, регламентированный интерфейс, интегрированный в среду 1С, для быстрого оформления заказов и приема платежей в точке продаж.

#### 1.2.1.3 Аппаратные интерфейсы
Интерфейс с роботизированным комплексом: Взаимодействие через промышленные протоколы связи (например, OPC UA, Modbus TCP) или REST/HTTP API, предоставляемое производителем роботов. Характеризуется набором команд (старт/стоп, загрузка рецепта, запрос статуса) и подпиской на события от оборудования.
Интерфейс с фискальным терминалом: Взаимодействие через драйверы и API, соответствующие ФФД 1.2 (Федеральный формат фискальных данных). Протокол включает команды на регистрацию чека, печать отчета и запрос статуса ФН.

#### 1.2.1.4 Программные интерфейсы

Название
Источник
Назначение
PostgreSQL
Open Source
Система управления реляционными базами данных для всех сервисов.
Apache Kafka
Apache Foundation
Брокер сообщений для асинхронной межсервисной коммуникации.
Java Runtime Environment
Oracle/OpenJDK
Среда выполнения для сервисов на Spring Boot.
Node.js
OpenJS Foundation
Среда выполнения для сервиса API Gateway.


Внутренние программные интерфейсы (API):
REST API (синхронный): Основной стиль взаимодействия между API Gateway и внутренними сервисами (ServiceOrder, ServiceMenu, ServicePayment и др.), а также между фронтенд-приложениями и бэкендом. Использует JSON в качестве формата данных. Аутентификация через JWT-токены, валидируемые API Gateway и ServiceAutorisation.
Event-Driven API (асинхронный): Реализован через Apache Kafka. Используется для фоновых и неблокирующих операций (например, после создания заказа ServiceOrder публикует событие OrderCreated, на которое подписываются ServiceStatistics и ServiceMessage). Формат сообщений – Apache Avro или JSON Schema.

#### 1.2.1.5 Интерфейсы связи
Внешние коммуникации: HTTPS/TLS 1.2+ для всех публичных API, предоставляемых API Gateway. Протоколы взаимодействия с внешними системами определяются их контрактами (REST, SOAP, AMQP).
Внутренние коммуникации: HTTP/2 или gRPC для синхронного взаимодействия между микросервисами внутри защищенного периметра. Apache Kafka (протокол TCP) для асинхронного обмена событиями.

#### 1.2.1.6 Ограничения памяти
Каждый микросервис должен быть рассчитан на работу в контейнере с минимальным выделением 512 МБ и рекомендуемым – 1-2 ГБ оперативной памяти (JVM heap).
Базы данных: Для каждой выделенной БД (DbOrders, DbMenu и т.д.) требуется планирование объема в соответствии с бизнес-метриками (например, DbOrders должна хранить историю заказов за 3 года). Необходимо предусмотреть возможность шардирования высоконагруженных БД (например, DbMain).

#### 1.2.1.7 Операции
Режимы работы: Система работает в режиме 18/7. Основные операции инициируются пользователями (покупатели, сотрудники).
Фоновые операции: Выполняются без присмотра (обработка событий из Kafka, отправка уведомлений, агрегация статистики).
Резервное копирование и восстановление: Ежедневное инкрементное и еженедельное полное резервное копирование всех баз данных и критичных конфигураций. Восстановление всей системы из резервной копии должно занимать не более 4 часов. Для Kafka настроен retention policy для топиков.

#### 1.2.1.8 Требования к адаптации на площадке
Конфигурация, специфичная для площадки: Все внешние endpoint (URL платежных систем, адреса роботов, параметры ФФД для терминала) выносятся во внешние конфигурационные файлы или хранилища (Config Server, Vault).
Инициализация данных: При первом развертывании должна быть загружена базовая структура меню, роли пользователей и технологические карты для роботов. Существует скрипт/сервис для первоначальной настройки.

#### 1.2.1.9 Интерфейсы со службами (SaaS/Cloud)
Сервис отправки SMS/Push-уведомлений: ServiceMessage взаимодействует с внешним SaaS-провайдером (например, Twilio, Firebase Cloud Messaging) через REST API для отправки сообщений конечным пользователям.
Облачное хранилище: Для хранения статических файлов (изображений блюд, логотипов) используется облачное объектное хранилище (например, AWS S3, Yandex Object Storage) через соответствующее SDK.
Мониторинг и логирование: Все сервисы интегрируются с облачными сервисами мониторинга (Prometheus/Grafana) и агрегации логов (ELK Stack, Loki), размещенными в инфраструктуре.

### 1.2.2 Функции продукта
Каталог и конфигуратор блюд: Динамическое отображение меню с учетом времени суток, остатков ингредиентов. Возможность кастомизации (убрать/добавить компонент).
Управление заказом и корзиной: Формирование, редактирование корзины. Интеллектуальный апселлинг (предложение комбо, допов).
Прием платежей: Интеграция с несколькими платежными шлюзами. Поддержка карт, оплата наличными, оплата QR-кодом. Печать/отправка фискального чека.
Диспетчеризация на кухню: Распределение задач между роботизированными модулями, оптимизация очереди заказов.
Управление выдачей: Присвоение ячейки выдачи, управление ее открытием по QR-коду, информирование клиента.
Мониторинг и аналитика: Реал-тайм дашборд по ключевым показателям (выручка, SRO, популярные позиции), формирование отчетов.
Управление контентом: Централизованное обновление меню, цен, промоматериалов на всех терминалах и табло.

### 1.2.3 Характеристики пользователей
Тип пользователя
Функция / Местоположение
Устройство
Кол-во (на точку)
Характер использования
Характеристики
Покупатель
Оформление и отслеживание заказа. Торговая зона, дом.
Табло, личный смартфон
Неограниченно
Спорадический, эпизодический. Требуется минимальное обучение.
Базовые навыки работы с сенсорными устройствами и браузером. Нет доступа к админ. функциям.
Кассир
Оформление заказов на точке, прием оплаты. Рабочее место кассира.
Компьютер с 1С, фискальный терминал
2-4
Постоянный, интенсивный в часы пик.
Обученный персонал. Работает в ограниченном интерфейсе 1С.
Менеджер/Администратор
Управление меню, ценами, мониторинг заказов и работы роботов. Офис, удаленно.
Рабочий ПК, ноутбук
1-3
Регулярный, несколько раз в день.
Технически подкованный пользователь. Имеет расширенные права в веб-интерфейсе.
Технический специалист
Настройка и мониторинг системы, просмотр логов.
Рабочая станция
1-2
Эпизодический, при возникновении инцидентов.
Высокая техническая квалификация. Доступ к системным интерфейсам и дашбордам.

### 1.2.4 Ограничения
Технические: Терминалы самообслуживания работают на ОС Windows 11 IoT/LTSB. Платежный шлюз предоставляет только REST API. Роботизированные комплексы имеют proprietary API на C++.
Бизнес-ограничения: Срок реализации — 12 месяцев. Бюджет разработки — не более 100 млн руб. Первый пилот должен быть запущен в г. Москва.
Нормативные: Система должна соответствовать ФЗ-54 «О применении ККТ», требованиям PCI DSS (уровень SAQ A) для обработки платежных данных, ГОСТ Р 54762-2011/ISO 9241-210 по эргономике.

## 1.3 Допущения и зависимости
Допущения: Заказчик обеспечит стабильный высокоскоростной канал связи (не менее 100 Мбит/с) на площадке. Поставляемое заказчиком оборудование (роботы, терминалы) будет сертифицировано и работоспособно.
Зависимости: Сроки реализации зависят от своевременного предоставления заказчиком спецификаций и API от поставщиков роботизированных комплексов. Работа платежного модуля зависит от внешних сервисов провайдера.
